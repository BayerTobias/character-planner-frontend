<div class="character-card">
  <button (click)="openDmgOverlay()">damage</button>

  @if (characterDataService.character) {
  <app-stat-box
    [strengthValue]="characterDataService.character!.strengthValue"
    [strengthBonus]="characterDataService.character!.strengthBonus"
    [agilityValue]="characterDataService.character!.agilityValue"
    [agilityBonus]="characterDataService.character!.agilityBonus"
    [constitutionValue]="characterDataService.character!.constitutionValue"
    [constitutionBonus]="characterDataService.character!.constitutionBonus"
    [intelligenceValue]="characterDataService.character!.intelligenceValue"
    [intelligenceBonus]="characterDataService.character!.intelligenceBonus"
    [charismaValue]="characterDataService.character!.charismaValue"
    [charismaBonus]="characterDataService.character!.charismaBonus"
  ></app-stat-box>

  <app-character-details
    [name]="characterDataService.character!.name"
    [maxHealth]="characterDataService.character!.maxHealth"
    [level]="characterDataService.character!.level"
  ></app-character-details>

  @for (skill of characterDataService.character.class.skills; track $index)
  {<app-skills-display [skill]="skill" [index]="$index"></app-skills-display>}
  @for (skill of characterDataService.character.customSkills; track $index) {
  <app-skills-display [skill]="skill" [index]="$index"></app-skills-display>
  } }
</div>

<div>
  <button
    (click)="toggleSelectArmor()"
    (keydown)="handleKeydown($event)"
    [attr.aria-expanded]="selectArmorOpen"
    aria-haspopup="listbox"
    [attr.aria-activedescendant]="
      selectArmorOpen ? 'armor-option-' + focusedArmorIndex : null
    "
  >
    {{ characterDataService.character?.armor?.name ?? "Select Armor" }}
  </button>

  @if (selectArmorOpen) {
  <ul role="listbox" tabindex="-1">
    @for (armor of gameDataService.baseArmors; track $index) {
    <li
      [id]="'armor-option-' + $index"
      [attr.aria-selected]="$index === focusedArmorIndex"
      [class.focused]="$index === focusedArmorIndex"
      (click)="selectArmor(armor)"
      role="option"
    >
      {{ armor.name }}
    </li>
    }
  </ul>
  }
</div>

<button (click)="skillDevelopMagic()">testskills</button>
@for ( customWeapon of characterDataService.character?.customWeapons; track
$index) {
<button (click)="openEditCustomWeapon(customWeapon)">
  {{ customWeapon.name }}
</button>

}

<button (click)="openCreateNewWeapon()">new Custom weapon</button>

@if(overlay){
<app-overlay-base
  (closeOverlayEvent)="closeOverlay()"
  [slectedCustomWeapon]="selectedCustomWeapon"
></app-overlay-base>
}
